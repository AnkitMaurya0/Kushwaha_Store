<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ product.name }} - Kushwaha Store</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/product_detail.css') }}">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-brand">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo">
                <h1>Kushwaha Store</h1>
            </div>
            <div class="nav-links">
                <a href="{{ url_for('home') }}">Home</a>
                <a href="{{ url_for('products') }}">All Products</a>
                {% if session.role %}
                    {% if session.role == 'buyer' %}
                        <a href="{{ url_for('buyer_dashboard') }}">Dashboard</a>
                        <a href="{{ url_for('cart') }}">Cart</a>
                        <a href="{{ url_for('orders') }}">My Orders</a>
                    {% endif %}
                    <a href="{{ url_for('logout') }}">Logout</a>
                {% else %}
                    <a href="{{ url_for('login') }}">Login</a>
                    <a href="{{ url_for('register') }}">Register</a>
                {% endif %}
            </div>
        </nav>
    </header>

    <main>
        <div class="container">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="flash-message {{ category }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <div class="product-detail">
                <div class="product-image">
                    <img src="{{ url_for('static', filename='images/' + product.image) }}" alt="{{ product.name }}">
                </div>
                
                <div class="product-info">
                    <h1>{{ product.name }}</h1>
                    <p class="vendor">Sold by: {{ product.vendor_name }}</p>
                    <p class="price">₹{{ "%.2f"|format(product.price) }}</p>
                    
                    <div class="description">
                        <h3>Description</h3>
                        <p>{{ product.description }}</p>
                    </div>
                    
                    {% if session.role == 'buyer' %}
                        <div class="purchase-options">
                            <a href="{{ url_for('buy_now', product_id=product.id) }}" class="btn btn-primary">Buy Now</a>
                            <a href="{{ url_for('add_to_cart', product_id=product.id) }}" class="btn btn-secondary">Add to Cart</a>
                        </div>
                    {% else %}
                        <div class="login-prompt">
                            <p><a href="{{ url_for('login') }}">Login</a> to purchase this product</p>
                        </div>
                    {% endif %}
                    
                    <div class="product-meta">
                        <p><strong>Added on:</strong> {{ product.created_at[:10] }}</p>
                    </div>
                </div>
            </div>

            <div class="back-to-products">
                <a href="{{ url_for('products') }}" class="btn btn-outline">← Back to All Products</a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Kushwaha Store. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>